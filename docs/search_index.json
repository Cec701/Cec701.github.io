[["basic-commands-and-view-files.html", "Intro to Sequencing Data &amp; UNIX Tutorial Chapter 1 Basic Commands and View Files ", " Intro to Sequencing Data &amp; UNIX Tutorial Christina Costa 2026-02-11 Chapter 1 Basic Commands and View Files 1.0.0.1 Open the Terminal application on your computer for Mac. For Windows, you should be able to access this if you have the Windows Subsystem for Linux (WSL) installed, which is run either via the Ubuntu or the Windows Terminal App. We are going to learn some basic UNIX commands and explore some raw sequence data files! Now the command line is not strictly a programming language but it does have a variety of tools and commands you can run in the shell. And you can write Bash scripts to execute on the command line. We will simply be entering commands directly in the terminal, but in theory we could place these in a Bash script to run again in the future, or to run on other input files. Additionally, you should open up a Word Document to write your answers to the Questions below. First, locate the ACE2 FASTA file you downloaded from NCBI last week (with the five orthologs in different species). You are likely in your “Users” directory on your computer. To change directories you are going to use the “cd” command. For example: cd /Desktop/ANTHP40149 You can also check what directory you are in with: pwd You should see the directory change to the left of where you type. You can also create directories using “mkdir”. This will create a new directory in whatever location you are currently in. mkdir Week3 Now, if we would like to see what files are in our current directory we can use another very useful command “ls”. Type “ls” and a list of your files and directories in that folder should appear. Now type “ls -lht”. This (-) is an example of a flag and modifies the command. Specifically, it tells it to output the user permissions, size, and dates modified for each file (-l), output this in a human readable format, in particular so we can understand file size (-h), and sort them by time, with the most recently modified first (-t). ls ls -lht If you want to learn more about a command take a look at the man page man ls Type q to quit. Or, if the man page does not exist for some commands you can also use the –help flag less --help Some basic commands: ls (list) mkdir (make directory) cp (copy file) mv (rename file) pwd (print working directory) Now we want to actually view the contents of our ACE2 FASTA file. We can do that from the command line with the “less” function. As usual in these tutorials, you may need to change the file names to match YOUR file: less ace2.fa This should print the file contents to the terminal. To scroll down use your space bar. To exit again type q for “quit”. Instead of “less” we could also use “cat” to view the content of a file. However cat prints the entire contents to the screen (which in a sequence data file can be extremely long!). To avoid that, less lets us just open the first part and scroll if we wish. This is a good moment to mention that if you make a mistake, and say cat a million line file you don’t have to panic and close your terminal! You can just hit CNTRL + C and it will stop whatever is running. "],["extract-information-about-our-sequence-data.html", "Chapter 2 Extract Information about our Sequence Data ", " Chapter 2 Extract Information about our Sequence Data A useful feature of a FASTA file is that each entry starts with the same symbol “&gt;”. If we count this symbol we can know how many sequences are in our file. In this case we of course already know, but for some larger files this may come in handy. We will use a command called grep. (stands for global regular expression print). It searches for text lines in a file that matches what is known as a regular expression. You can get fancy with this, but we do not need to. grep &quot;&gt;&quot; ace2.fa Now this prints the lines that have that character in parentheses. But we want to know how many lines. Thankfully, grep has a flag for that! We are going to add the -c flag, which will count the number of lines in our file with that symbol. In our case, this should be five, the number of ACE2 sequences we have. grep -c &quot;&gt;&quot; ace2.fa Now, download the two FASTQ files from Brightspace for today. Remember this is the raw data we get from the sequencing machine. One of these contains short reads and the other long reads. A very useful character to know is the asterisk symbol, which is a universal expression, it stands for anything, better known as a wild card. The following line will show you all your files ending in fastq.gz. Make sure to change your directory if needed using cd to the file location. ls -lht *fastq.gz Note: these files are in a compressed format (.gz). The same commands will work but first you need to unzip it. Do not do this by clicking on the file! Keep it zipped. We will only unzip it in the Terminal. Use the gzcat command followed by your file name. This is the same as the cat command but it works on gzipped files. Then we will introduce a new topic called piping. Piping is when you write one command, then insert this character “|”. Then you write another command that is performed on whatever the first output is. Essentially you are feeding the output of the first part into the second command. Remember, you need to type the actual file name: gzcat unknown.fastq.gz | less Piping is one type of input and output redirection. This can be done in several ways: Store program’s output in a file to be saved (&gt;). Direct a program to take input from a file (&lt;). Direct the output to be another program’s input (|) Take a look at each using less. Do you notice any differences between the FASTA file and these two FASTQ files? We can count how many lines total are in a file with the wc -l command. You can do this for both but it will give you the same answer because I subset these files to the same number of lines (the complete sequencing data files were quite large). gzcat unknown.fastq.gz | wc -l But that does not tell us how many reads are in a file, which is what we are usually interested in. To do that we rely on the fact that each FASTQ file should have 4 lines per read. So we can simply divide the number we got above by 4 to get the total number of reads. Or we can do the more complicated line below. Note: bc stands for basic calculator. Unfortunately this will not work without the echo which prints the value of the command in parentheses following the $ to standard output so we can then divide by 4. Do not worry too much about this, if you start spending a lot of time doing shell scripting you will get used to some of these features. echo $(gzcat unknown.fastq | wc -l)/4 | bc In theory we could use the same logic as above for the FASTA and just grep and count the number of “@” signs that start the FASTQ header. Unfortunately, this same character can be used in the last quality score line (Phred score). 2.0.0.1 Question 1. From only visually examining the reads, which of these FASTQ files is most likely the output of long-read sequencing and which is from short-read sequencing? In this case we are not interested in the number of reads in the sequencing run but how many bases are sequenced in each read. There is a way to do this in command line using some fancy awk commands but that is beyond the scope of this intro. I will include the line for reference below so you can check your answer. 2.0.0.2 Question 2. Do you think these reads are single or paired-end? Hint: look at the number of FASTQ files I provided you for each sample and the headers of the reads. Note: while paired-end reads are useful in short-read technology like Illumina, and help with e.g., aligning to a reference genome, with long-read sequencing it is not needed. This line will output the average read length in the FASTQ file: gzcat unknown.fastq.gz | awk &#39;NR%4==2 {print length}&#39; | awk &#39;{sum += $1; count++} END {print sum/count}&#39; For those interested more info on the command: &quot;To break this down, NR stands for number of records, or current line number, the % is a remainder symbol (the leftover value when dividing current line number in this case by 4), and with the == 2, is essentially saying for every four line block, print the length of the second line. Remember that every read entry has four lines, and the second line has the actual sequence. The length of each sequence line is then piped into another awk command, where the sequence lengths are summed together. count++ keeps a record of how many sequences have been summed. Once that is done END, it then prints the sum of all the sequences divided by the count (so that average read length). This type of syntax is really quite complex I often have to look it up again and can only do basic things off the top of my head. For now, I am only interested in you being able to use some of the basic command line tools shown earlier. &quot; "],["fastq-sample-info.html", "Chapter 3 FASTQ Sample Info ", " Chapter 3 FASTQ Sample Info HG02486 is a modern individual from Barbados who is part of the Human Pangenome Reference Consortium project (PacBIO SMRT) https://humanpangenome.org/ ERR12040069 is an individual from Mesolithic Russia, dated to at least 9,000 years ago (Illumina HiSeq 4000) https://www.nature.com/articles/s41586-023-06865-0 Click to view more sample info &quot;Ural River, Orenburg region, Cis-Urals, Russia. River beach find. Mikhail Sablin. A partly destroyed human skull was personally found on the Ural River beach in the Orenburg region by the Russian palaeontologist N.K. Vereshchagin in 1956. Dating of the human bone NEO100, SR-8457 around 9.1 kya 14C BP corresponds to the Romanov-Il’murzin culture, Mesolithic in the Cis-Urals chronology. The material has not been published before.&quot; "],["save-your-terminal-session.html", "Chapter 4 Save Your Terminal Session ", " Chapter 4 Save Your Terminal Session You can export a session in terminal if you want to save it for future reference. In our case, we are going to be submitting these as part of our assignment. To do so, go to “Shell” and “Export Text As” and give it a name that makes sense (do not just save it as “Terminal Saved Output”!) and select where you want to save it to. "],["assessing-sequencing-data-quality-fastqc.html", "Chapter 5 Assessing Sequencing Data Quality (FASTQC) ", " Chapter 5 Assessing Sequencing Data Quality (FASTQC) Download and open the FASTQC results (two HTML files) for both the files you viewed above. 5.0.0.1 Question 3 (FASTQ Summary). FASTQC will also show you some summary stats. From the report, for each FASTQ file, what is the total number of sequences? The total number of bases? What is the range in sequence length? 5.0.0.2 Question 4. (Sequencing Quality). Do you notice any quality issues in the FASTQC report of either file? What might each indicate about the data? Review the info on each parameter in more depth here: https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/ Take a look at a “good Illumina FASTQC report”: https://www.bioinformatics.babraham.ac.uk/projects/fastqc/good_sequence_short_fastqc.html And a bad: https://www.bioinformatics.babraham.ac.uk/projects/fastqc/bad_sequence_fastqc.html Click to view more about the ancient sample and fragmentation &quot;The ancient DNA actually appears to be fairly decent quality from this quick report, besides what are clearly some flow cell failures. Although it is ancient, it is not nearly as old as many samples we have extracted DNA from. In addition, this is a modern publication, meaning they were using the most up to date library prep methods for ancient DNA, which likely increased the quality. The one thing you may have noticed is a shorter fragment length for some reads that is not just due to it being short read sequencing but the input DNA fragments themselves often being shorter than the intended read length. Click to view more about the ancient sample and base content &quot;One thing I found interesting is the higher G and C per base content and GC content compared to the other modern long read sequencing. I expected the opposite because in ancient DNA a chemical degradation process occurs where cytosines (Cs) are deaminated into uracil, which then appears as a thymine (T) substitution. However, some ancient DNA libary prep ends up enriching for more stable GC rich regions! Deamination usually occurs most at the 5&#39; end of the ancient DNA fragments. If you look at per base content for the first few positions of the read (reads are 5&#39; to 3&#39;) it actually does show lower % Cytosines and greater % Thymines!&quot; 5.0.0.3 Question 5. (Sequencing Technology): Compare the Illumina (ERR12040069) and PacBio (HG02486) FASTQC reports. What differences do you notice? Most of the time a few orange or even red symbols does not mean something is terribly wrong and you need to throw out your data. Some of these errors can be addressed during data processing (Week 6), e.g., trimming low quality bases especially at the ends of reads, removing adapters if present in reads (although our sequences here have none!). FASTQC was created for short-read Illumina sequencing data, and therefore is not well-tuned for other types of data. For example, you likely noticed the odd presence of PolyA content in the Adapter Content summary for the long reads. This is a known artifact. A Poly-A tail as a reminder is a repetitive sequence of As that is added after transcription to the 3’ end of a messenger RNA transcript. Remember, we are sequencing the genomic DNA here, not RNA, so these reads should not actually contain real Poly-A sequences. I have never done long-read sequencing but I believe e.g., PacBIO SMRT has their own quality control report they provide that is more specific to the data generated. Another program fastp claims to work better on long read data. Download the fastp.HG02486.html from Brightspace as well and compare this to the FASTQC report. This provides similar information in a different format. Note: I generated these FASTQC reports for you to avoid having to install software. But you can run fastqc on your sequencing data from the command line (or the available App) and it will generate the same output. You can download fastqc here: (https://www.bioinformatics.babraham.ac.uk/projects/fastqc/). Feel free to download and do so using the provided FASTQ files. However, we can do the same via a web-based application called Galaxy that we will return to in Week 6, and for our final assignment. fastqc unknown.fastq "],["submit-your-work.html", "Chapter 6 Submit Your Work ", " Chapter 6 Submit Your Work Upload you Word Document with your answers (Word or PDF format are both fine), and your saved Terminal session text file to the Assignment on Brightspace. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
